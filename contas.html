<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FF Status - Painel Akira</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

    <style>
        :root { 
            --primary: #f02849; 
            --bg: #0b0e11; 
            --card: #1c2128; 
            --text: #ffffff; 
            --gray: #8b949e;
        }

        body { 
            font-family: 'Segoe UI', Tahoma, sans-serif; 
            background: var(--bg); 
            color: var(--text); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
        }

        .box { 
            background: var(--card); 
            padding: 30px; 
            border-radius: 12px; 
            width: 350px; 
            text-align: center; 
            border: 1px solid #30363d; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.5); 
        }

        .btn-x { 
            background: #000; 
            color: white; 
            border: 1px solid #333; 
            padding: 12px; 
            width: 100%; 
            border-radius: 6px; 
            font-weight: bold; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 10px; 
            margin-top: 20px; 
            transition: 0.3s;
        }

        .btn-x:hover { background: #111; }

        .hidden { display: none; }

        .status-box { 
            margin-top: 20px; 
            padding: 15px; 
            background: #0d1117; 
            border-radius: 8px; 
            border-left: 5px solid var(--primary); 
            text-align: left; 
        }

        .on { color: #23d160; } 
        .black { color: #ffdd57; } 
        .ban { color: #ff3860; }

        .user-info { 
            display: flex; 
            align-items: center; 
            gap: 12px; 
            margin-bottom: 20px; 
            text-align: left; 
            border-bottom: 1px solid #30363d;
            padding-bottom: 15px;
        }

        .user-info img { 
            width: 45px; 
            height: 45px; 
            border-radius: 50%; 
            border: 2px solid var(--primary); 
        }

        .logout-link {
            margin-top: 25px;
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            text-decoration: underline;
            font-size: 13px;
        }
    </style>
</head>
<body>

    <div id="loginPage" class="box">
        <h2 style="margin: 0 0 10px 0;">Consultar Conta FF</h2>
        <p style="color: var(--gray); font-size: 14px;">Acesse com seu X para verificar o status de banimento ou blacklist.</p>
        
        <button class="btn-x" onclick="loginComX()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="white"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
            Entrar com X
        </button>
    </div>

    <div id="dashboard" class="box hidden">
        <div class="user-info">
            <img id="userPhoto" src="" alt="Avatar">
            <div>
                <div id="userName" style="font-weight: bold;"></div>
                <div style="font-size: 12px; color: var(--gray);">Autenticado via X</div>
            </div>
        </div>

        <div class="status-box">
            <p style="font-size: 11px; margin: 0; color: var(--gray); text-transform: uppercase;">Status do Jogador:</p>
            <h3 id="statusResult" style="margin: 5px 0;">ANALISANDO...</h3>
            <p id="details" style="font-size: 13px; margin: 0; color: var(--gray);"></p>
        </div>

        <button onclick="logout()" class="logout-link">Sair da conta</button>
    </div>

    <script>
        // CONFIGURAÇÃO DO SEU FIREBASE
        const firebaseConfig = {
            apiKey: "AIzaSyADWH-HdJUFByEuHBdHZkf7mDSD1-dBnRA",
            authDomain: "cpx-akira.firebaseapp.com",
            databaseURL: "https://cpx-akira-default-rtdb.firebaseio.com",
            projectId: "cpx-akira",
            storageBucket: "cpx-akira.firebasestorage.app",
            messagingSenderId: "126066483108",
            appId: "1:126066483108:web:49f39f30edbf1c6775eb31"
        };
        
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        // 1. PEDIR PERMISSÃO PARA NOTIFICAÇÕES
        function pedirPermissao() {
            if ("Notification" in window) {
                Notification.requestPermission();
            }
        }

        // 2. ENVIAR NOTIFICAÇÃO QUANDO FICAR ON
        function avisarQueEstaOn() {
            if (Notification.permission === "granted") {
                new Notification("FF Status - Akira", {
                    body: "Sua conta já está ATIVA (ON)! Pode logar no Free Fire agora.",
                    icon: "https://cdn-icons-png.flaticon.com/512/190/190411.png"
                });
            }
        }

        // 3. LOGAR COM X
        function loginComX() {
            const provider = new firebase.auth.TwitterAuthProvider();
            auth.signInWithPopup(provider)
                .then((result) => {
                    pedirPermissao();
                    exibirPainel(result.user);
                }).catch((error) => {
                    alert("Erro no login: " + error.message);
                });
        }

        // 4. EXIBIR O PAINEL E GERAR O STATUS
        function exibirPainel(user) {
            document.getElementById('loginPage').classList.add('hidden');
            document.getElementById('dashboard').classList.remove('hidden');
            document.getElementById('userName').innerText = user.displayName;
            document.getElementById('userPhoto').src = user.photoURL;

            const res = document.getElementById('statusResult');
            const det = document.getElementById('details');
            
            // Lógica aleatória para demonstração
            const sorteio = Math.random();

            if(sorteio > 0.6) {
                res.innerText = "ATIVA (ON)"; res.className = "on";
                det.innerText = "Nenhuma restrição detectada no servidor.";
            } 
            else if (sorteio > 0.3) {
                // LÓGICA DA BLACKLIST (OFF) COM CRONÔMETRO
                res.className = "black";
                det.innerText = "Aguarde o término da análise de segurança.";
                
                // Definindo 3 dias para o cronômetro (mude para segundos se quiser testar rápido)
                let tempoRestante = (3 * 24 * 60 * 60 * 1000); 
                let dataFinal = new Date().getTime() + tempoRestante;

                const contagem = setInterval(function() {
                    let agora = new Date().getTime();
                    let distancia = dataFinal - agora;

                    let d = Math.floor(distancia / (1000 * 60 * 60 * 24));
                    let h = Math.floor((distancia % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    let m = Math.floor((distancia % (1000 * 60 * 60)) / (1000 * 60));
                    let s = Math.floor((distancia % (1000 * 60)) / 1000);

                    res.innerText = `OFF (${d}d, ${h}hrs, ${m}min e ${s}seg)`;

                    if (distancia < 0) {
                        clearInterval(contagem);
                        res.innerText = "ATIVA (ON)";
                        res.className = "on";
                        det.innerText = "Sua conta saiu da Blacklist!";
                        avisarQueEstaOn(); // Dispara a notificação
                    }
                }, 1000);
            } 
            else {
                res.innerText = "BANIDA"; res.className = "ban";
                det.innerText = "Conta suspensa permanentemente por uso de software de terceiros.";
            }
        }

        function logout() {
            auth.signOut().then(() => location.reload());
        }

        auth.onAuthStateChanged((user) => {
            if (user) exibirPainel(user);
        });
    </script>
</body>
</html>
